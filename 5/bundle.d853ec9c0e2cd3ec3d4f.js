(()=>{"use strict";function e(e){const t=document.createElement("div");return t.innerHTML=e,t.firstElementChild}function t(e,t,n="beforeend"){t.insertAdjacentElement(n,e.getElement())}class n{getTemplate(){return'\n    <ul class="trip-events__list">\n    </ul>\n  '}getElement(){return this.element||(this.element=e(this.getTemplate())),this.element}removeElement(){this.element=null}}const i={1:"JAN",2:"FEB",3:"MAR",4:"APR",5:"MAY",6:"JUN",7:"JUL",8:"AUG",9:"SEP",10:"OCT",11:"NOV",12:"DEC"},s=(e,t)=>{const n=Math.ceil(Math.min(Math.abs(e),Math.abs(t))),i=Math.floor(Math.max(Math.abs(e),Math.abs(t))),s=Math.random()*(i-n+1)+n;return Math.floor(s)},r=e=>e[Math.floor(Math.random()*e.length)],l=[{id:"1",name:"Taxi"},{id:"2",name:"Bus"},{id:"3",name:"Train"},{id:"4",name:"Ship"},{id:"5",name:"Drive"},{id:"6",name:"Flight"},{id:"7",name:"Check-in"},{id:"8",name:"Sightseeing"},{id:"9",name:"Restaurant"}],a=[{id:"1",description:"Chamonix, is a beautiful city, a true asian pearl, with crowded streets.",name:"Chamonix",pictures:[{src:"http://picsum.photos/300/200?r=0.0762563005163317",description:"Chamonix parliament building"}]},{id:"2",description:"",name:"Amsterdam",pictures:[{src:"http://picsum.photos/300/200?r=0.0762563005163317",description:"Chamonix parliament building"}]},{id:"3",description:"",name:"Geneva",pictures:[{src:"http://picsum.photos/300/200?r=0.0762563005163317",description:"Chamonix parliament building"}]},{id:"4",description:"",name:"Paris",pictures:[]}],o=e=>a[a.findIndex((t=>t.id===e))],p=[{type:"taxi",offers:[{id:"1",title:"Upgrade to a business class",price:120},{id:"2",title:"Order Uber",price:20}]},{type:"sightseeing",offers:[{id:"3",title:"Book tickets",price:40},{id:"4",title:"Lunch in city",price:30}]},{type:"flight",offers:[{id:"5",title:"Add luggage",price:50},{id:"6",title:"Switch to comfort",price:80},{id:"7",title:"Add meal",price:15},{id:"8",title:"Choose seats",price:5},{id:"9",title:"Travel by train",price:40}]}],d=e=>{for(let t=0;t<p.length;t++)for(let n=0;n<p[t].offers.length;n++)if(p[t].offers[n].id===e)return p[t].offers[n];return null};class c{constructor(e){this.routePoint=e}getTemplate(){return function(e){const{type:t,destination:n,date_from:s,date_to:r,base_price:a,offers:p}=e,c=s.split("T")[0],_=(e=>{const t=+e.split("-")[1],n=e.split("-")[2];return`${i[t]} ${n}`})(c),u=s.split("T")[1].slice(0,5),f=r.split("T")[1].slice(0,5),v=new Date(s),m=new Date(r),h=(e=>{e=e/1e3/60;const t=Math.floor(e/1440),n=Math.floor((e-1440*t)/60),i=e%60;let s="";return t&&(s+=`${String(t)}D `),s+=`${String(n).padStart(2,"0")}H `,s+=`${String(i).padStart(2,"0")}M`,s})(new Date(m-v)),g=(b=t,l[l.findIndex((e=>e.name.toLowerCase()===b.toLowerCase()))]);var b;const y=o(n);let $="";if(p&&p.length)for(let e=0;e<p.length;e++){const t=d(p[e]);$+=`\n        <li class="event__offer">\n        <span class="event__offer-title">${t.title}</span>\n        &plus;&euro;&nbsp;\n        <span class="event__offer-price">${t.price}</span>\n      </li>\n    `}return`\n    <li class="trip-events__item">\n      <div class="event">\n        <time class="event__date" datetime="${c}">${_}</time>\n        <div class="event__type">\n          <img class="event__type-icon" width="42" height="42" src="img/icons/${g.name}.png" alt="Event type icon">\n        </div>\n        <h3 class="event__title">${g.name} ${y.name}</h3>\n        <div class="event__schedule">\n          <p class="event__time">\n            <time class="event__start-time" datetime="${s}">${u}</time>\n            &mdash;\n            <time class="event__end-time" datetime="${r}">${f}</time>\n          </p>\n          <p class="event__duration">${h}</p>\n        </div>\n        <p class="event__price">\n          &euro;&nbsp;<span class="event__price-value">${a}</span>\n        </p>\n        <h4 class="visually-hidden">Offers:</h4>\n        <ul class="event__selected-offers">\n          ${$}\n        </ul>\n        <button class="event__favorite-btn event__favorite-btn--active" type="button">\n          <span class="visually-hidden">Add to favorite</span>\n          <svg class="event__favorite-icon" width="28" height="28" viewBox="0 0 28 28">\n            <path d="M14 21l-8.22899 4.3262 1.57159-9.1631L.685209 9.67376 9.8855 8.33688 14 0l4.1145 8.33688 9.2003 1.33688-6.6574 6.48934 1.5716 9.1631L14 21z"/>\n          </svg>\n        </button>\n        <button class="event__rollup-btn" type="button">\n          <span class="visually-hidden">Open event</span>\n        </button>\n      </div>\n    </li>\n  `}(this.routePoint)}getElement(){return this.element||(this.element=e(this.getTemplate())),this.element}removeElement(){this.element=null}}const _=e=>{const t=Math.floor(e/60);return e%=60,`${String(t).padStart(2,"0")}:${String(e).padStart(2,"0")}:00.0Z`},u=()=>{const e=r(l).id,t=(n=e,l[l.findIndex((e=>e.id===n))]);var n;const i=(e=>{for(let t=0;t<p.length;t++)if(p[t].type.toLowerCase()===e.name.toLowerCase()){const e=Object.keys(p[t].offers).length,n=s(0,e),i=Array.from({length:n},(()=>r(p[t].offers).id)),l=new Set(i);return Array.from(l,(e=>e))}return null})(t),o=s(1,15),d=s(0,1440),c=_(d),u=o+s(0,7),f=s(d,1440),v=_(f);return{id:s(1,1e5),base_price:s(1,1e3),date_from:`2024-08-${String(o).padStart(2,"0")}T${c}`,date_to:`2024-08-${String(u).padStart(2,"0")}T${v}`,destination:r(a).id,is_favorite:!1,offers:i,type:t.name.toLowerCase()}},f=e=>new Date(e),v=(e,t)=>t.base_price-e.base_price,m=(e,t)=>f(e.date_from)-f(t.date_from);class h{route=Array.from({length:8},u);getRoute(){return this.route.sort(v),this.route}}class g{getTemplate(){return function(){const e="Flight";return`\n    <li class="trip-events__item">\n      <form class="event event--edit" action="#" method="post">\n        <header class="event__header">\n          <div class="event__type-wrapper">\n            <label class="event__type  event__type-btn" for="event-type-toggle-1">\n              <span class="visually-hidden">Choose event type</span>\n              <img class="event__type-icon" width="17" height="17" src="img/icons/flight.png" alt="Event type icon">\n            </label>\n            <input class="event__type-toggle  visually-hidden" id="event-type-toggle-1" type="checkbox">\n\n            <div class="event__type-list">\n              <fieldset class="event__type-group">\n                <legend class="visually-hidden">Event type</legend>\n                ${function(e){let t="";for(let n=0;n<l.length;n++){const i=l[n].name.toLowerCase()===e.toLowerCase()?"checked":"";t+=`\n      <div class="event__type-item">\n        <input id="event-type-${l[n].name.toLowerCase()}-1" class="event__type-input  visually-hidden"\n        type="radio" name="event-type" value="${l[n].name.toLowerCase()}" ${i}>\n        <label class="event__type-label  event__type-label--${l[n].name.toLowerCase()}"\n        for="event-type-${l[n].name.toLowerCase()}-1">${l[n].name}</label>\n      </div>`}return t}(e)}\n              </fieldset>\n            </div>\n          </div>\n\n          <div class="event__field-group  event__field-group--destination">\n            <label class="event__label  event__type-output" for="event-destination-1">\n              ${e}\n            </label>\n            <input class="event__input  event__input--destination" id="event-destination-1" type="text" name="event-destination"\n            value="Chamonix" list="destination-list-1">\n            <datalist id="destination-list-1">\n              ${function(){let e="";for(let t=0;t<a.length;t++)e+=`<option value="${a[t].name}"></option>`;return e}()}\n            </datalist>\n          </div>\n\n          <div class="event__field-group  event__field-group--time">\n            <label class="visually-hidden" for="event-start-time-1">From</label>\n            <input class="event__input  event__input--time" id="event-start-time-1" type="text" name="event-start-time" value="18/03/19 12:25">\n            &mdash;\n            <label class="visually-hidden" for="event-end-time-1">To</label>\n            <input class="event__input  event__input--time" id="event-end-time-1" type="text" name="event-end-time" value="18/03/19 13:35">\n          </div>\n\n          <div class="event__field-group  event__field-group--price">\n            <label class="event__label" for="event-price-1">\n              <span class="visually-hidden">Price</span>\n              &euro;\n            </label>\n            <input class="event__input  event__input--price" id="event-price-1" type="text" name="event-price" value="160">\n          </div>\n\n          <button class="event__save-btn  btn  btn--blue" type="submit">Save</button>\n          <button class="event__reset-btn" type="reset">Delete</button>\n          <button class="event__rollup-btn" type="button">\n            <span class="visually-hidden">Open event</span>\n          </button>\n        </header>\n        <section class="event__details">\n          <section class="event__section  event__section--offers">\n            <h3 class="event__section-title  event__section-title--offers">Offers</h3>\n\n            <div class="event__available-offers">\n              ${function(){let e="";for(let t=0;t<p.length;t++)if(p[t].type.toLowerCase()==="Flight".toLowerCase())for(let n=0;n<p[t].offers.length;n++)e+=`\n          <div class="event__offer-selector">\n            <input class="event__offer-checkbox  visually-hidden" id="event-offer-${p[t].offers[n].id}"\n            type="checkbox" name="event-offer-${p[t].offers[n].id}">\n            <label class="event__offer-label" for="event-offer-${p[t].offers[n].id}">\n              <span class="event__offer-title">${p[t].offers[n].title}</span>\n              &plus;&euro;&nbsp;\n              <span class="event__offer-price">${p[t].offers[n].price}</span>\n            </label>\n          </div>\n        `;return e}()}\n            </div>\n          </section>\n\n          <section class="event__section  event__section--destination">\n            <h3 class="event__section-title  event__section-title--destination">Destination</h3>\n            <p class="event__destination-description">${a[a.findIndex((e=>e.name.toLowerCase()==="Chamonix".toLowerCase()))].description}</p>\n          </section>\n        </section>\n      </form>\n    </li>\n  `}()}getElement(){return this.element||(this.element=e(this.getTemplate())),this.element}removeElement(){this.element=null}}const b=document.querySelector(".trip-main"),y=document.querySelector(".trip-controls__filters"),$=document.querySelector(".trip-events"),C=new class{routeComponent=new n;route=new h;routePoints=this.route.getRoute();constructor({routeContainer:e}){this.routeContainer=e}getTripTitle(){const e=this.routePoints.slice();e.sort(m);const t=Array.from(e,(e=>o(e.destination).name)),n=new Set(t);return Array.from(n,(e=>e)).join(" - ")}getTripDates(){const e=this.routePoints.slice().sort(m),t=new Date(e[0].date_from),n=new Date(e.slice(-1)[0].date_to);return s=t.getDate(),r=t.getMonth()+1,l=n.getDate(),r===(a=n.getMonth()+1)?`${String(s).padStart(2,"0")} - ${String(l).padStart(2,"0")}\n            ${i[r]}`:`${String(s).padStart(2,"0")} ${i[r]} -\n          ${String(l).padStart(2,"0")} ${i[a]}`;var s,r,l,a}getTripCost(){let e=0;for(let t=0;t<this.routePoints.length;t++)if(e+=this.routePoints[t].base_price,this.routePoints[t].offers&&this.routePoints[t].offers.length)for(let n=0;n<this.routePoints[t].offers.length;n++)e+=d(this.routePoints[t].offers[n]).price;return e}updateTripInfo(){document.querySelector(".trip-info__title").textContent=this.getTripTitle(),document.querySelector(".trip-info__dates").textContent=this.getTripDates(),document.querySelector(".trip-info__cost-value").textContent=this.getTripCost()}init(){t(this.routeComponent,this.routeContainer),t(new g,this.routeComponent.getElement());const e=this.routePoints.length;for(let n=0;n<e;n++)t(new c(this.routePoints[n]),this.routeComponent.getElement());this.updateTripInfo()}}({routeContainer:$});t(new class{getTemplate(){return'\n    <section class="trip-main__trip-info  trip-info">\n      <div class="trip-info__main">\n        <h1 class="trip-info__title">Amsterdam &mdash; Chamonix &mdash; Geneva</h1>\n\n        <p class="trip-info__dates">18&nbsp;&mdash;&nbsp;20 Mar</p>\n      </div>\n\n      <p class="trip-info__cost">\n        Total: &euro;&nbsp;<span class="trip-info__cost-value">1230</span>\n      </p>\n    </section>\n  '}getElement(){return this.element||(this.element=e(this.getTemplate())),this.element}removeElement(){this.element=null}},b,"afterbegin"),t(new class{getTemplate(){return'\n    <form class="trip-filters" action="#" method="get">\n      <div class="trip-filters__filter">\n        <input id="filter-everything" class="trip-filters__filter-input  visually-hidden" type="radio" name="trip-filter" value="everything">\n        <label class="trip-filters__filter-label" for="filter-everything">Everything</label>\n      </div>\n\n      <div class="trip-filters__filter">\n        <input id="filter-future" class="trip-filters__filter-input  visually-hidden" type="radio" name="trip-filter" value="future">\n        <label class="trip-filters__filter-label" for="filter-future">Future</label>\n      </div>\n\n      <div class="trip-filters__filter">\n        <input id="filter-present" class="trip-filters__filter-input  visually-hidden" type="radio" name="trip-filter" value="present">\n        <label class="trip-filters__filter-label" for="filter-present">Present</label>\n      </div>\n\n      <div class="trip-filters__filter">\n        <input id="filter-past" class="trip-filters__filter-input  visually-hidden" type="radio" name="trip-filter" value="past" checked>\n        <label class="trip-filters__filter-label" for="filter-past">Past</label>\n      </div>\n\n      <button class="visually-hidden" type="submit">Accept filter</button>\n    </form>\n  '}getElement(){return this.element||(this.element=e(this.getTemplate())),this.element}removeElement(){this.element=null}},y),t(new class{getTemplate(){return'\n    <form class="trip-events__trip-sort  trip-sort" action="#" method="get">\n      <div class="trip-sort__item  trip-sort__item--day">\n        <input id="sort-day" class="trip-sort__input  visually-hidden" type="radio" name="trip-sort" value="sort-day">\n        <label class="trip-sort__btn" for="sort-day">Day</label>\n      </div>\n\n      <div class="trip-sort__item  trip-sort__item--event">\n        <input id="sort-event" class="trip-sort__input  visually-hidden" type="radio" name="trip-sort" value="sort-event" disabled>\n        <label class="trip-sort__btn" for="sort-event">Event</label>\n      </div>\n\n      <div class="trip-sort__item  trip-sort__item--time">\n        <input id="sort-time" class="trip-sort__input  visually-hidden" type="radio" name="trip-sort" value="sort-time">\n        <label class="trip-sort__btn" for="sort-time">Time</label>\n      </div>\n\n      <div class="trip-sort__item  trip-sort__item--price">\n        <input id="sort-price" class="trip-sort__input  visually-hidden" type="radio" name="trip-sort" value="sort-price" checked>\n        <label class="trip-sort__btn" for="sort-price">Price</label>\n      </div>\n\n      <div class="trip-sort__item  trip-sort__item--offer">\n        <input id="sort-offer" class="trip-sort__input  visually-hidden" type="radio" name="trip-sort" value="sort-offer" disabled>\n        <label class="trip-sort__btn" for="sort-offer">Offers</label>\n      </div>\n    </form>\n  '}getElement(){return this.element||(this.element=e(this.getTemplate())),this.element}removeElement(){this.element=null}},$),C.init()})();
//# sourceMappingURL=bundle.d853ec9c0e2cd3ec3d4f.js.map